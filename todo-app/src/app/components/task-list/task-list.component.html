<div class="slds-card slds-p-around_medium">

  <!-- Header -->
  <div class="slds-grid slds-grid_align-spread slds-m-bottom_small">
    <h2 class="slds-text-heading_medium">Tasks</h2>

    <div>
      <button class="slds-button slds-button_brand" (click)="openNewTask()">New Task</button>
      <button class="slds-button slds-button_neutral slds-m-left_small" (click)="refresh()">Refresh</button>
    </div>
  </div>

  <!-- Search -->
  <div class="slds-input-has-icon slds-input-has-icon_right slds-m-bottom_small">
    <input type="text" class="slds-input" placeholder="Search" [(ngModel)]="searchText" />
    <span class="slds-icon_container slds-input__icon slds-input__icon_right">
      üîç
    </span>
  </div>

  <!-- Table -->
  <table class="slds-table slds-table_cell-buffer slds-table_bordered">
    <thead>
      <tr>
        <th>Assigned To</th>
        <th>Status</th>
        <th>Due Date</th>
        <th>Priority</th>
        <th>Comments</th>
        <th></th>
      </tr>
    </thead>

    <tbody>
      <tr *ngFor="let t of filteredTasks">
        <td>{{ t.assignedTo }}</td>
        <td>{{ t.status }}</td>
        <td>{{ t.dueDate }}</td>
        <td>{{ t.priority }}</td>
        <td>{{ t.description }}</td>

        <td class="slds-text-align_right">

          <!-- Dropdown button -->
          <div class="slds-dropdown-trigger slds-dropdown-trigger_click">

            <button class="slds-button slds-button_icon" (click)="toggleDropdown(t.id)">
              ‚ãÆ
            </button>

            <!-- Dropdown menu -->
            <div *ngIf="dropdownOpenId === t.id" class="slds-dropdown slds-dropdown_right">
              <ul class="slds-dropdown__list" role="menu">
                <li class="slds-dropdown__item" (click)="editTask(t.id)">
                  <span>Edit</span>
                </li>

                <li class="slds-dropdown__item" (click)="openDeleteModal(t)">
                  <span>Delete</span>
                </li>
              </ul>
                              <!-- DELETE MODAL -->
                <div *ngIf="showDeleteModal" class="slds-modal slds-fade-in-open">
                  <div class="slds-modal__container">

                    <header class="slds-modal__header">
                      <h2 class="slds-text-heading_medium">Delete this task?</h2>
                    </header>

                    <div class="slds-modal__content slds-p-around_medium">
                      <p class="slds-text-body_regular">
                        Are you sure you want to delete
                        <strong>{{ selectedTask?.description || 'this task' }}</strong>?
                      </p>
                    </div>

                    <footer class="slds-modal__footer">
                      <button class="slds-button slds-button_neutral" (click)="closeDeleteModal()">Cancel</button>
                      <button class="slds-button slds-button_destructive" (click)="confirmDelete()">Delete</button>
                    </footer>

                  </div>
                </div>

                <div *ngIf="showDeleteModal" class="slds-backdrop slds-backdrop_open"></div>

            </div>

          </div>

        </td>
      </tr>
    </tbody>
  </table>

</div>
